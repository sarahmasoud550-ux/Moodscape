<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>UAE Moodscape — Gentle Support (Not a Therapist)</title>
  <style>
    :root {
      --bg: #0b0d10;
      --panel: #12161b;
      --muted: #8aa0b3;
      --text: #e7eef5;
      --brand: #4cc9f0;
      --brand-2: #80ed99;
      --danger: #ff6b6b;
      --warning: #ffd166;
      --ok: #2ec4b6;
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --radius: 16px;
    }
    * { box-sizing: border-box }
    html,body { height: 100% }
    body {
      margin: 0; font: 16px/1.5 system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, Noto Sans, "Apple Color Emoji", "Segoe UI Emoji";
      color: var(--text); background: radial-gradient(1200px 800px at 80% -10%, rgba(76,201,240,.08), transparent 50%) , radial-gradient(900px 600px at -10% 120%, rgba(128,237,153,.08), transparent 50%), var(--bg);
    }
    a { color: var(--brand) }

    .wrap { max-width: 1100px; margin: 0 auto; padding: 24px }

    .notice {
      background: linear-gradient(135deg, rgba(255,107,107,.12), rgba(255,209,102,.1));
      border: 1px solid rgba(255,255,255,.08);
      padding: 18px 16px; border-radius: var(--radius); box-shadow: var(--shadow);
      display: grid; gap: 10px; align-items: start; margin-bottom: 22px;
    }
    .notice h1 { font-size: 18px; margin: 0; letter-spacing: .2px }
    .notice p { margin: 0 }
    .phones { display: grid; grid-template-columns: 1fr; gap: 12px; margin-top: 8px }
@media (min-width: 720px) { .phones { grid-template-columns: repeat(2, minmax(260px, 1fr)); } }
@media (min-width: 1100px) { .phones { grid-template-columns: repeat(3, minmax(260px, 1fr)); } }
    .pill { background: rgba(255,255,255,.06); border: 1px solid rgba(255,255,255,.12); padding: 12px 14px; border-radius: 999px; display: grid; gap: 4px; align-items: start; width: 100% }
    .pill strong { display: block; white-space: normal }

    header {
      display: grid; grid-template-columns: 1fr auto; gap: 16px; align-items: end; margin: 10px 0 24px
    }
    .brand { font-weight: 700; font-size: 28px; letter-spacing: .2px }
    .brand small { font-weight: 500; color: var(--muted); font-size: 14px }
    .btn {
      appearance: none; border: none; cursor: pointer; border-radius: 12px; padding: 12px 16px; font-weight: 600; box-shadow: var(--shadow);
      background: linear-gradient(180deg, var(--brand), #2aa3ca); color: #051018; transition: transform .06s ease, box-shadow .12s ease;
    }
    .btn:active { transform: translateY(1px); box-shadow: 0 4px 16px rgba(0,0,0,.25) }
    .btn.secondary { background: linear-gradient(180deg, #344a5f, #263546); color: var(--text) }

    .grid { display: grid; grid-template-columns: 1fr; gap: 18px }
    @media (min-width: 920px) {
      .grid { grid-template-columns: 380px 1fr }
    }

    .card { background: var(--panel); border: 1px solid rgba(255,255,255,.08); border-radius: var(--radius); box-shadow: var(--shadow); padding: 18px }
    .card h2 { margin: 0 0 12px; font-size: 18px }
    .help { color: var(--muted); font-size: 14px; margin-top: 6px }

    .chips { display: flex; gap: 10px; flex-wrap: wrap }
    .chip { border: 1px solid rgba(255,255,255,.25); background: rgba(255,255,255,.10); padding: 10px 14px; border-radius: 999px; cursor: pointer; user-select: none; color: var(--text); font-weight: 600 }
    .chip[aria-pressed="true"] { background: rgba(76,201,240,.28); border-color: rgba(76,201,240,.8); box-shadow: inset 0 0 0 2px rgba(76,201,240,.35) }
.chip:focus-visible { outline: 3px solid var(--brand); outline-offset: 2px }

    .textarea { width: 100%; min-height: 160px; padding: 12px; color: var(--text); background: rgba(255,255,255,.04); border: 1px solid rgba(255,255,255,.12); border-radius: 12px; resize: vertical }
    .row { display: flex; gap: 10px; align-items: center; flex-wrap: wrap }

    .result { display: grid; gap: 16px }
    .section-title { font-weight: 700; font-size: 16px; margin: 10px 0 4px }

    .cards { display: grid; grid-template-columns: repeat(auto-fit,minmax(240px,1fr)); gap: 12px }

/* Split list + viewer layout */
.split { display: grid; gap: 12px }
@media (min-width: 900px) { .split { grid-template-columns: 320px 1fr } }
.list { display: flex; flex-direction: column; gap: 8px; max-height: 420px; overflow: auto }
.item { border: 1px solid rgba(255,255,255,.12); background: rgba(255,255,255,.04); padding: 10px 12px; border-radius: 12px; cursor: pointer }
.item:hover { background: rgba(255,255,255,.07) }
.item[aria-selected="true"] { background: rgba(76,201,240,.20); border-color: rgba(76,201,240,.6) }
.viewer { background: rgba(255,255,255,.03); border: 1px solid rgba(255,255,255,.08); border-radius: 12px; padding: 8px }
    .place, .sound, .tip {
      background: rgba(255,255,255,.04); border: 1px solid rgba(255,255,255,.08); border-radius: 12px; padding: 12px; display: grid; gap: 8px
    }
    .meta { color: var(--muted); font-size: 13px }

/* Embedded media */
.embed { width: 100%; border: 0; border-radius: 12px; box-shadow: var(--shadow) }
.embed.map { aspect-ratio: 4 / 3; min-height: 240px }
.embed.video { aspect-ratio: 16 / 9 }

details { background: rgba(255,255,255,.03); border: 1px solid rgba(255,255,255,.08); border-radius: 12px; padding: 10px 12px }
details > summary { cursor: pointer; list-style: none; font-weight: 600; color: var(--brand); margin: -10px -12px 8px; padding: 10px 12px }
details[open] > summary { border-bottom: 1px solid rgba(255,255,255,.08); margin-bottom: 10px }

    .spinner { width: 18px; height: 18px; border: 3px solid rgba(255,255,255,.25); border-top-color: var(--brand); border-radius: 50%; display: inline-block; animation: spin .9s linear infinite }
    @keyframes spin { to { transform: rotate(360deg) } }

    .footnote { font-size: 13px; color: var(--muted) }
    .sr-only { position: absolute !important; clip: rect(1px,1px,1px,1px); padding:0;border:0;height:1px;width:1px;overflow:hidden;white-space:nowrap }
  </style>
</head>
<body>
  <div class="wrap">
    <!-- Disclaimer / Safety banner -->
    <div class="notice" role="note" aria-label="Safety notice">
      <h1>Gentle reminder: This site is <em>not</em> a therapist or a crisis service.</h1>
      <p>If you feel unsafe or might hurt yourself or someone else, or if someone is in immediate danger, please contact emergency services <strong>right now</strong>.</p>
      <div class="phones" aria-label="UAE hotlines">
        <div class="pill"><strong>Police</strong> <span>999</span></div>
        <div class="pill"><strong>Ambulance</strong> <span>998</span></div>
        <div class="pill"><strong>Mental Support Line</strong> <span>800‑HOPE (8004673), daily 8am–8pm</span></div>
        <div class="pill"><strong>Abu Dhabi “Estijaba”</strong> <span>8001717 (psychological support option)</span></div>
        <div class="pill"><strong>DFWAC (Women & Children)</strong> <span>800111 (24/7)</span></div>
      </div>
      <p class="help">Numbers above are for UAE residents. This site offers educational suggestions only and cannot provide diagnosis or treatment.</p>
    </div>

    <header>
      <div>
        <div class="brand">UAE Moodscape <small>— calm, places, and sounds</small></div>
        <div class="help">Choose how you want to start. You can select feelings, write to the AI agent, or do both.</div>
      </div>
      <div class="row">
        <button id="analyzeBtn" class="btn"><span class="lbl">Analyze & Suggest</span> <span id="spin" class="spinner" style="display:none"></span></button>
        <button id="resetBtn" class="btn secondary">Reset</button>
      </div>
    </header>

    <div class="grid">
      <section class="card" aria-labelledby="feelings-title">
        <h2 id="feelings-title">1) Pick what you’re feeling (optional)</h2>
        <div class="chips" id="chips"></div>
        <p class="help">Tap to toggle. You can choose more than one.</p>
      </section>

      <section class="card" aria-labelledby="agent-title">
        <h2 id="agent-title">2) Tell the AI agent about your situation (optional)</h2>
        <label class="sr-only" for="story">Describe what’s going on</label>
        <textarea id="story" class="textarea" placeholder="e.g., I’ve been feeling anxious about exams and not sleeping well lately..."></textarea>
        <div class="row" style="margin-top:8px">
          <label><input type="checkbox" id="includeSelfCare" checked /> Include self‑care suggestions</label>
        </div>
        <p class="help">Privacy: Your text is processed in your browser in demo mode (no data leaves your device). Embedded Google Maps and YouTube players load from those services.</p>
      </section>
    </div>

    <section id="results" class="card" aria-live="polite" aria-busy="false">
      <h2>Suggestions</h2>
      <div id="aiMessage" class="help"></div>

      <div class="section-title">Places you could visit</div>
      <div id="placesSplit" class="split">
        <div id="placesList" class="list" role="listbox" aria-label="Places"></div>
        <div class="viewer">
          <iframe id="mapViewer" class="embed map" loading="lazy" referrerpolicy="no-referrer-when-downgrade" title="Map viewer"></iframe>
        </div>
      </div>

      <div class="section-title">Nature sounds to try</div>
      <div id="soundsSplit" class="split">
        <div id="soundsList" class="list" role="listbox" aria-label="Sounds"></div>
        <div class="viewer">
          <iframe id="videoViewer" class="embed video" loading="lazy" title="Video player" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
        </div>
      </div>

      <div class="section-title">Small steps you can take</div>
      <div id="tips" class="cards"></div>

      <p class="footnote" id="safetyNote"></p>
    </section>

    <p class="footnote">Made with care for UAE residents. <strong>Disclaimer:</strong> This site is not medical advice. If you’re in crisis, use the numbers at the top.</p>
  </div>

  <script>
    // --- Data ---------------------------------------------------------------
    const FEELINGS = [
      'sad', 'anxious', 'stressed', 'overwhelmed', 'angry', 'frustrated', 'lonely', 'burned out', 'tired', 'worried'
    ];

    // Curated UAE locations (sample, non-exhaustive). Each entry can include a mood-fit array.
    const UAE_PLACES = [
      { name: 'Jubail Mangrove Park', emirate: 'Abu Dhabi', kind: 'nature • boardwalk', moods: ['anxious','stressed','sad','overwhelmed'], maps: 'Jubail+Mangrove+Park' },
      { name: 'Saadiyat Public Beach', emirate: 'Abu Dhabi', kind: 'beach • calm water', moods: ['sad','anxious','tired','overwhelmed'], maps: 'Saadiyat+Public+Beach' },
      { name: 'Umm Al Emarat Park', emirate: 'Abu Dhabi', kind: 'park • shaded paths', moods: ['stressed','anxious','lonely','sad'], maps: 'Umm+Al+Emarat+Park' },
      { name: 'Al Ain Oasis', emirate: 'Al Ain', kind: 'oasis • heritage', moods: ['anxious','overwhelmed','lonely'], maps: 'Al+Ain+Oasis' },
      { name: 'Jebel Jais Viewing Deck', emirate: 'Ras Al Khaimah', kind: 'mountains • scenic', moods: ['frustrated','angry','burned out'], maps: 'Jebel+Jais+Viewing+Deck' },
      { name: 'Hatta Dam', emirate: 'Dubai (Hatta)', kind: 'kayak • turquoise water', moods: ['angry','frustrated','stressed','burned out'], maps: 'Hatta+Dam' },
      { name: 'Al Qudra Lakes', emirate: 'Dubai', kind: 'lakes • cycling track', moods: ['stressed','lonely','burned out'], maps: 'Al+Qudra+Lakes' },
      { name: 'Kite Beach', emirate: 'Dubai', kind: 'promenade • sunset walk', moods: ['sad','tired','anxious','frustrated'], maps: 'Kite+Beach+Dubai' },
      { name: 'Al Fahidi Historical Neighbourhood', emirate: 'Dubai', kind: 'heritage • quiet alleys', moods: ['overwhelmed','anxious','lonely'], maps: 'Al+Fahidi+Historical+Neighbourhood' },
      { name: 'Alserkal Avenue', emirate: 'Dubai', kind: 'arts • cafes', moods: ['lonely','sad','burned out'], maps: 'Alserkal+Avenue' },
      { name: 'Sharjah Beach (Al Khan)', emirate: 'Sharjah', kind: 'beach • gentle waves', moods: ['sad','anxious','tired'], maps: 'Al+Khan+Beach' },
      { name: 'Sharjah Art Museum', emirate: 'Sharjah', kind: 'museum • quiet rooms', moods: ['overwhelmed','anxious','stressed'], maps: 'Sharjah+Art+Museum' }
    ];

    // Nature sound themes. Link opens a YouTube search to avoid copyright & broken embeds.
    const SOUND_THEMES = [
      { label: 'Ocean waves', moods: ['sad','anxious','tired','overwhelmed'], query: 'ocean+waves+10+hours' },
      { label: 'Light rain', moods: ['sad','anxious','stressed','tired'], query: 'rain+sounds+10+hours' },
      { label: 'Forest ambience', moods: ['anxious','overwhelmed','burned out'], query: 'forest+ambience+birds+relaxing' },
      { label: 'Desert night wind', moods: ['frustrated','angry','burned out'], query: 'desert+wind+ambience+night' },
      { label: 'Creek / gentle water', moods: ['stressed','anxious'], query: 'gentle+stream+water+sounds' },
      { label: 'Brown noise (softer than white)', moods: ['anxious','tired','overwhelmed'], query: 'brown+noise+sleep+focus' }
    ];

    const GENERIC_TIPS = [
      { text: 'Box breathing 4‑4‑4‑4 (inhale, hold, exhale, hold) for 3 minutes.' },
      { text: 'Step outside for 10 minutes of daylight or a short walk.' },
      { text: 'Drink water and have a small snack if you haven’t eaten recently.' },
      { text: 'Text or call someone you trust and tell them how you’re feeling.' },
      { text: 'Write down one worry and one small action you can take today.' }
    ];

    // --- UI Boot ------------------------------------------------------------
    const chipsEl = document.getElementById('chips');
    FEELINGS.forEach(f => {
      const b = document.createElement('button');
      b.className = 'chip';
      b.type = 'button';
      b.role = 'button';
      b.setAttribute('aria-pressed', 'false');
      b.dataset.value = f;
      b.textContent = f.charAt(0).toUpperCase() + f.slice(1);
      b.addEventListener('click', () => {
        const on = b.getAttribute('aria-pressed') === 'true';
        b.setAttribute('aria-pressed', String(!on));
      });
      chipsEl.appendChild(b);
    });

    const analyzeBtn = document.getElementById('analyzeBtn');
    const resetBtn   = document.getElementById('resetBtn');
    const storyEl    = document.getElementById('story');
    const aiMsgEl    = document.getElementById('aiMessage');
    const placesList = document.getElementById('placesList');
    const mapViewer  = document.getElementById('mapViewer');
    const soundsList = document.getElementById('soundsList');
    const videoViewer= document.getElementById('videoViewer');
    const tipsEl     = document.getElementById('tips');
    const spinEl     = document.getElementById('spin');
    const safetyNote = document.getElementById('safetyNote');

    resetBtn.addEventListener('click', () => {
      storyEl.value = '';
      aiMsgEl.textContent = '';
      document.querySelectorAll('.chip').forEach(c => c.setAttribute('aria-pressed','false'));
      placesList.innerHTML = '';
      soundsList.innerHTML = '';
      tipsEl.innerHTML = '';
      mapViewer.removeAttribute('src');
      videoViewer.removeAttribute('src');
      safetyNote.textContent = '';
    });

    analyzeBtn.addEventListener('click', async () => {
      const chosen = Array.from(document.querySelectorAll('.chip[aria-pressed="true"]')).map(c => c.dataset.value);
      const story = (storyEl.value || '').trim();
      if (!chosen.length && !story) {
        aiMsgEl.textContent = 'Please select at least one feeling or share a few lines with the AI agent.';
        return;
      }
      analyzeBtn.disabled = true;
      spinEl.style.display = 'inline-block';

      try {
        const result = await analyzeViaServer(chosen, story);
        renderResult(result);
      } catch (err) {
        console.error(err);
        aiMsgEl.textContent = 'Could not reach the AI service. Please check your API key or try again.';
      } finally {
        spinEl.style.display = 'none';
        analyzeBtn.disabled = false;
      }
    });

    // --- Demo AI (on-device heuristic) -------------------------------------
    async function analyzeViaServer(moods, story) {
      const res = await fetch("/api/ai", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ moods, story })
      });

      let data = {};
      try { data = await res.json(); } catch (_) {}

      if (!res.ok) {
        console.error("API error:", res.status, data);
        throw new Error(data?.detail || data?.error || `AI HTTP ${res.status}`);
      }

      const inferred = (data.inferredMoods || []).map(s => s.toLowerCase());
      const isUnclear = inferred.length === 1 && inferred[0] === "unclear";
      if (isUnclear) {
        return { aiText: data.aiText || "I’m not sure I understood. Could you rephrase what you’re feeling?", places: [], sounds: [], tips: [] };
      }

      const effectiveMoods = (moods && moods.length) ? moods : inferred;
      const heuristic = analyzeLocally([...effectiveMoods], story);
      return { aiText: data.aiText || heuristic.aiText, places: heuristic.places, sounds: heuristic.sounds, tips: heuristic.tips };
    }


    function analyzeLocally(moods, story) {
      // Extract keywords and normalize.
      const text = (story || '').toLowerCase();
      const kw = {
        sleep: /(sleep|insomnia|tired|fatigue)/.test(text),
        study: /(exam|school|study|assignment|university|test)/.test(text),
        work:  /(work|boss|job|deadline|burnout|burned\s*out)/.test(text),
        social: /(lonely|alone|friends?|breakup|relationship)/.test(text),
        anger: /(angry|mad|furious|irritated|frustrated)/.test(text),
        anxiety: /(anxiety|anxious|panic|worry|worried|nervous)/.test(text),
      };

      // Expand moods from text if none selected.
      if (!moods.length) {
        if (kw.anxiety) moods.push('anxious');
        if (kw.anger) moods.push('angry');
        if (kw.social) moods.push('lonely');
        if (kw.sleep) moods.push('tired');
        if (!moods.length) moods = ['stressed'];
      }

      // Score places by how many mood tags they match.
      const placeScores = UAE_PLACES.map(p => ({
        place: p,
        score: p.moods.reduce((s,m)=> s + (moods.includes(m)?1:0), 0)
      })).sort((a,b)=> b.score - a.score || a.place.name.localeCompare(b.place.name));
      const topPlaces = placeScores.filter(x=>x.score>0).slice(0,6).map(x=>x.place);
      const fallbackPlaces = UAE_PLACES.slice(0,6);

      // Pick sounds that align with moods.
      const topSounds = SOUND_THEMES.filter(s => s.moods.some(m => moods.includes(m))).slice(0,6);

      // Tips — choose a few and add a targeted one.
      const tips = [...GENERIC_TIPS];
      if (kw.sleep) tips.unshift({ text: 'Aim for a gentle wind-down routine 60–90 minutes before bed (dim lights, no heavy screens, stretch).' });
      if (kw.study) tips.unshift({ text: 'Try a 25-minute focus block near daylight, followed by a 5-minute walk break.' });
      if (kw.work) tips.unshift({ text: 'Block a 15-minute “reset” break between meetings to breathe and step outside if possible.' });
      if (kw.social) tips.unshift({ text: 'Message one person today and ask to meet for a short walk or coffee.' });
      if (kw.anger) tips.unshift({ text: 'Do 3 rounds of brisk walking or light stairs to discharge tension before conversations.' });

      // Compose a gentle AI paragraph (fallback if server doesn’t send one)
      const moodLine = moods.length
        ? `I’m hearing themes like ${moods.map(m=>`<strong>${m}</strong>`).join(', ')}.`
        : 'Thanks for sharing — I’ll keep suggestions gentle and flexible.';
      const note = `This isn’t therapy. If you feel unsafe or in crisis, please call <strong>999</strong> (police) or <strong>998</strong> (ambulance). For mental support you can call <strong>800-HOPE (8004673)</strong> daily 8am–8pm, Abu Dhabi’s <strong>Estijaba 8001717</strong> (psychological support option), or <strong>DFWAC 800111</strong> for women & children.`;
      const aiText = `${moodLine} Based on that, here are calm places, sounds, and small steps that often help in the UAE. ${note}`;

      return {
        aiText,
        places: topPlaces.length ? topPlaces : fallbackPlaces,
        sounds: topSounds.length ? topSounds : SOUND_THEMES.slice(0,4),
        tips: tips.slice(0,6)
      };
    }

    // --- Render -------------------------------------------------------------
    function renderResult({ aiText, places, sounds, tips }) {
      aiMsgEl.innerHTML = aiText;

      // If unclear: invite the user to clarify and skip the lists
      if ((!places || places.length === 0) && (!sounds || sounds.length === 0) && (!tips || tips.length === 0)) {
        placesList.innerHTML = '';
        soundsList.innerHTML = '';
        tipsEl.innerHTML = '';
        mapViewer.removeAttribute('src');
        videoViewer.removeAttribute('src');

        const hint = document.createElement('div');
        hint.className = 'help';
        hint.style.marginTop = '8px';
        hint.textContent = 'Please add a bit more detail (e.g., is it sleep, studies, relationships, or work?).';
        aiMsgEl.appendChild(hint);

        // put the cursor back so they can type again
        storyEl.focus();
        return;
      }

      // (existing rendering for normal case)
      // PLACES: list (left) + viewer (right)
      placesList.innerHTML = '';
      mapViewer.removeAttribute('src');
      let firstPlaceURL = '';
      places.forEach((p, idx) => {
        const item = document.createElement('button');
        item.className = 'item';
        item.setAttribute('role', 'option');
        item.setAttribute('aria-selected', 'false');
        item.innerHTML = `<div><strong>${p.name}</strong></div><div class="meta">${p.emirate} • ${p.kind}</div>`;
        const q = (p.maps || p.name).replace(/\+/g, ' ');
        const url = `https://www.google.com/maps?q=${encodeURIComponent(q)}&output=embed`;
        if (idx === 0) firstPlaceURL = url;
        item.addEventListener('click', () => {
          document.querySelectorAll('#placesList .item').forEach(el => el.setAttribute('aria-selected','false'));
          item.setAttribute('aria-selected','true');
          mapViewer.src = url;
        });
        placesList.appendChild(item);
      });
      const firstPlace = placesList.querySelector('.item');
      if (firstPlace) { firstPlace.click(); } else if (firstPlaceURL) { mapViewer.src = firstPlaceURL; }

      // SOUNDS
      soundsList.innerHTML = '';
      videoViewer.removeAttribute('src');
      let firstVideoURL = '';
      sounds.forEach((s, idx) => {
        const item = document.createElement('button');
        item.className = 'item';
        item.setAttribute('role', 'option');
        item.setAttribute('aria-selected', 'false');
        item.innerHTML = `<div><strong>${s.label}</strong></div><div class="meta">First YouTube result</div>`;
        const q = s.query.replace(/\+/g, ' ');
        const url = `https://www.youtube-nocookie.com/embed?listType=search&list=${encodeURIComponent(q)}&rel=0&modestbranding=1`;
        if (idx === 0) firstVideoURL = url;
        item.addEventListener('click', () => {
          document.querySelectorAll('#soundsList .item').forEach(el => el.setAttribute('aria-selected','false'));
          item.setAttribute('aria-selected','true');
          videoViewer.src = url;
        });
        soundsList.appendChild(item);
      });
      const firstSound = soundsList.querySelector('.item');
      if (firstSound) { firstSound.click(); } else if (firstVideoURL) { videoViewer.src = firstVideoURL; }

      // TIPS
      tipsEl.innerHTML = '';
      for (const t of tips) {
        const el = document.createElement('div');
        el.className = 'tip';
        el.textContent = t.text;
        tipsEl.appendChild(el);
      }

      safetyNote.innerHTML = `Remember: this tool can’t diagnose or treat. If symptoms persist, consider speaking with a licensed professional in the UAE (e.g., via your emirate’s health services).`;
    }


    // --- (Optional) Server-side AI hook ------------------------------------ ------------------------------------
    // If you later add a server endpoint, you can swap analyzeLocally with a fetch:
    // async function analyzeViaServer(moods, story) {
    //   const res = await fetch('/api/ai', {method: 'POST', headers: {'Content-Type':'application/json'}, body: JSON.stringify({moods, story})});
    //   if (!res.ok) throw new Error('AI error');
    //   return await res.json(); // Expect { aiText, places, sounds, tips }
    // }
  </script>
</body>
</html>
